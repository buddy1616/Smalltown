<!doctype html>
<html lang="en">
<head>
	<title>Smalltown</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Expires" content="0">
	<meta name="description" content="Smalltown - Powered by TextCity Engine">
	<style>
		html *
		{
			font-size: 2.5vh;
			touch-action: manipulation;
		}

		body, html
		{
			height: 100%;
			margin: 0;
			padding: 0;
			width: 100%;
		}
		body
		{
			background: #000000;
			font-family: Arial;
			margin: 0;
		}
		h1
		{
			font-size: 4vh;
			margin-bottom: .5vh;
			margin-top: .5vh;
			text-align: center;
		}
		h2, h3, h4, h5
		{
			font-size: 1em;
			font-weight: normal;
			margin: 0;
			padding: 0;
		}
		div
		{
			vertical-align: top;
		}
		button
		{
			cursor:pointer;
			overflow-x: hidden;
			white-space: nowrap;
		}
		p
		{
			margin: 0 0 1vh 0;
			padding: 0;
		}
		ul
		{
			list-style: none;
			margin: 0;
			padding: 0 0 0 .5vh;
		}
		
		/* landscape */
		@media (min-aspect-ratio: 4/3)
		{
			#gameBox
			{
				width: 112vh;
			}
			#narrationBox
			{
				display: inline-block;
				vertical-align: top;
				height: 90vh;
				width: 53vh;
			}
			#controlsBox
			{
				display: inline-block;
				vertical-align: top;
				width: 53vh;
			}
			#viewBox
			{
				height: 80vh;
			}
			#layout-main
			{
				height: 80vh;
			}
			#view-currentArea
			{
				height: 79vh;
			}
			#tabBox
			{
				height: 63vh;
			}
			.tabcontent
			{
				height: 55vh;
			}
		}

		/* portrait */
		@media (max-aspect-ratio: 4/3)
		{
			#gameBox
			{
				width: 56vh;
			}
			#narrationBox
			{
				display: block;
				height: 20vh;
				margin: 5px;
			}
			#viewBox
			{
				height: 60vh;
			}
			#layout-main
			{
				height: 60vh;
			}
			#view-currentArea
			{
				height: 59vh;
			}
			#tabBox
			{
				height: 43vh;
			}
			.tabcontent
			{
				height: 35vh;
			}
		}
		
		#narrationBox
		{
			color: #000000;
			padding: 0 10px 0 10px;
			border: 1px solid;
			overflow-y: auto;
		}
		#gameBox
		{
			height: 99vh;
			margin-left: auto;
			margin-right: auto;
			padding-top: .5vh;
			text-align: center;
			background: #ffffff;
		}
		#view-currentArea
		{
			border: 1px solid;
		}		
		
		#navigationButtons
		{
			text-align: center;
		}
		
		#miniCalendar
		{
			text-align: center;
		}
		
		.tabcontent
		{
			overflow-y: scroll;
		}
		.itemTable
		{
			width: 100%;
		}
		.itemTable tbody tr td:first-child
		{
			text-align: left;
		}
		.itemTable tbody tr td:last-child
		{
			text-align: right;
		}
		
		/* layout styles */
		.subcontent
		{
			display: none;
		}
		
		/* screen styles */
		#content-pregame
		{
			background: #ffffff;
		}
		
		/* object styles */
		.narrationMessage
		{
			text-align: left;
			text-size: 0.8em;
		}
		.signTextNarrationMessage
		{
			text-align: center;
			font-style: italic;
			text-size: 0.8em;
			border: 1px solid;
			margin: 0 3vh 3vh 3vh;
			padding: 1vh;
		}
		.stackedEmoji ~ .stackedEmoji
		{
			position: relative;
			left: -2.25vh;
		}
		.stackedEmoji ~ .stackedEmoji ~ .stackedEmoji
		{
			position: relative;
			left: -4.5vh;
		}
		.stackedEmoji ~ .stackedEmoji ~ .stackedEmoji ~ .stackedEmoji
		{
			position: relative;
			left: -6.75vh;
		}
		.stackedEmoji ~ .stackedEmoji ~ .stackedEmoji ~ .stackedEmoji ~ .stackedEmoji
		{
			position: relative;
			left: -9vh;
		}
		.sunEmoji
		{
			color: #ffff33;
		}
		.moonEmoji
		{
			color: #ccccff;
		}
		.morning
		{
			background: #bbddff;
			color: #000000;
		}
		.tabcontrols
		{
			border-bottom: 1px solid;
		}
		.tabcontrol
		{
			color: #000000;
			position: relative;
			display: inline-block;
			border-top: 1px solid;
			border-left: 1px solid;
			border-right: 1px solid;
			border-radius: .5vh .5vh 0 0;
			padding: .5vh;
			vertical-align: bottom;
		}
		.tabcontrol[data-selected="true"]
		{
			background: #ffffff;
			height: 3.1vh;
			top: 1px;
		}
		.tabcontrol[data-selected="false"]
		{
			background: #cccccc;
			height: 2.5vh;
		}
		
		.skillInterface
		{
			display: none;
		}
		
		/* button styles */
		.menuButton
		{
			border: .1vh solid #000000;
			color: #ffffff;
			font-size: 4vh;
			height: 10vh;
			margin: .2vh .1vh .2vh .1vh;
			width: 30%;
			white-space: normal;
			word-wrap: break-word;
		}
		.navButton
		{
			width: 45%;
		}
		.navButton:disabled
		{
			opacity: 50%;
		}
		.featureActionButton
		{
			
		}
		.greenButton
		{
			background: #00aa00;
			color: #ffffff;
		}
		.ochreButton
		{
			background: #ddaa00;
			color: #000000;
		}
		.redButton
		{
			background: #aa0000;
			color: #ffffff;
		}
		.blueButton
		{
			background: #0000aa;
			color: #ffffff;
		}
	</style>
	<script src="TextCity.js"></script> 
	<script> // globals
		worldState.foragedThisWeek = [];
		modConfig.gamePreferences = {
			areaTabOnTravel: true
		};
	</script>
	<script> // items
		modData.items = {
			BEEF: {
				id: 'BEEF',
				displayName: 'beef',
				pluralName: 'beef',
				description: 'A cut of beef.',
				value: 5,
				maxStack: 999
			},
			BLACKBERRY: {
				id: 'BLACKBERRY',
				displayName: 'blackberry',
				pluralName: 'blackberries',
				description: 'A small black, delicious, berry.',
				value: 1,
				maxStack: 999
			},
			BREAD_CAMPFIRE: {
				id: 'BREAD_CAMPFIRE',
				displayName: 'campfire bread',
				pluralName: 'campfire bread',
				description: 'A hard, bland bread, cooked in a pot on a campfire.',
				value: 30,
				maxStack: 1
			},
			BREADKNIFE: {
				id: 'BREADKNIFE',
				displayName: 'breadknife',
				pluralName: 'breadknives',
				description: 'A very used, old, breadknife.',
				value: 0,
				maxStack: 1,
				questItem: true
			},
			BURGER_RUSTIC: {
				id: 'BURGER_RUSTIC',
				displayName: 'rustic burger',
				pluralName: 'rustic burgers',
				description: 'A very simple, bland burger made over a campfire.',
				value: 55,
				maxStack: 1
			},
			CHEFSKNIFE: {
				id: 'CHEFSKNIFE',
				displayName: 'chef\'s knife',
				pluralName: 'chef\'s knives',
				description: 'A once nice knife, it looks like its been thrown around too much.',
				value: 0,
				maxStack: 1,
				questItem: true
			},
			CLEAVER: {
				id: 'CLEAVER',
				displayName: 'cleaver',
				pluralName: 'cleavers',
				description: 'A well-loved, used meat cleaver.',
				value: 0,
				maxStack: 1,
				questItem: true
			},
			DOUGH_BASIC: {
				id: 'DOUGH_BASIC',
				displayName: 'basic dough',
				pluralName: 'basic doughs',
				description: 'An easy, basic, kneaded dough for simple breads.',
				value: 20,
				maxStack: 1
			},
			FLOUR_WHEAT: {
				id: 'FLOUR_WHEAT',
				displayName: 'wheat flour',
				pluralName: 'wheat flour',
				description: 'A fine flour made from wheat.',
				value: 5,
				maxStack: 999
			},
			KABOB_STEAK: {
				id: 'KABOB_STEAK',
				displayName: 'steak kabob',
				pluralName: 'steak kabobs',
				description: 'Skewered beef roasted over an open flame.',
				value: 20,
				maxStack: 999
			},
			MARSHMALLOW: {
				id: 'MARSHMALLOW',
				displayName: 'marshmallow',
				pluralName: 'marshmallows',
				description: 'A squishy white confection. Good for making s\'mores.',
				value: 1,
				maxStack: 999
			},
			MARSHMALLOW_ROASTED: {
				id: 'MARSHMALLOW_ROASTED',
				displayName: 'roasted marshmallow',
				pluralName: 'roasted marshmallows',
				description: 'A marshmallow, roasted over an open flame.',
				value: 2,
				maxStack: 999
			},
			POT_OLD: {
				id: 'POT_OLD',
				displayName: 'old pot',
				pluralName: 'old pots',
				description: 'A beat up, old, pot.',
				value: 0,
				maxStack: 999,
				questItem: true
			},
			SPINACH: {
				id: 'SPINACH',
				displayName: 'spinach',
				pluralName: 'spinach',
				description: 'A tasty, leafy green, rich in iron.',
				value: 10,
				maxStack: 999
			},
			SPINACH_SEED: {
				id: 'SPINACH_SEED',
				displayName: 'spinach seed',
				pluralName: 'spinach seeds',
				description: 'Seeds to grow spinach.',
				value: 5,
				maxStack: 999
			},
			YEAST: {
				id: 'YEAST',
				displayName: 'yeast',
				pluralName: 'yeast',
				description: 'A microfungus that is used in breadmaking.',
				value: 1,
				maxStack: 999
			}
		};
	</script>
	<script> // type definitions
		modData.types.activities = {
			CHILLING: {displayName: 'chilling'},
			EATING: {displayName: 'eating'},
			GAMING: {displayName: 'gaming'},
			HOME: {displayName: 'going home'},
			READING: {displayName: 'reading'},
			SLEEPING: {displayName: 'sleeping'},
			STUDYING: {displayName: 'studying'},
			THINKING: {displayName: 'thinking'},
			WALKING_N: {displayName: 'walking north'},
			WALKING_E: {displayName: 'walking east'},
			WALKING_S: {displayName: 'walking south'},
			WALKING_W: {displayName: 'walking west'},
			WORKING: {displayName: 'working'}
		};
		modData.types.aesthetics = {
			ALT: {displayName: 'alternative'},
			CASUAL: {displayName: 'casual'},
			CUTE: {displayName: 'cute'},
			DAPPER: {displayName: 'dapper'},
			HIPSTER: {displayName: 'hipster'},
			NERDY: {displayName: 'nerdy'},
			RUSTIC: {displayName: 'rustic'}
		};
		modData.types.bodies = {
			AVERAGE: {displayName: 'average'},
			CHUBBY: {displayName: 'chubby'},
			CURVY: {displayName: 'curvy'},
			DADBOD: {displayName: 'dad bod'},
			FIT: {displayName: 'fit'},
			THIN: {displayName: 'thin'}
		};
		modData.types.eyeColors = {
			BLUE: {displayName: 'blue'},
			BROWN: {displayName: 'brown'},
			GREEN: {displayName: 'green'},
			HAZEL: {displayName: 'hazel'}
		};
		//TODO come up with some way for different cooking features to modify results or limit by recipe
		modData.types.features = {
			...modData.types.features,
			CAMPFIRE: { displayName: 'Camp Fire',
				description: 'A circle of rocks that you can load wood into and make a fire. Good for roasting marshmallows, and preparing rustic food.',
				options: { canCook: true }},
			DEBRIS: { displayName: 'Debris', description: function(f){ return getDebrisDescription(f.level); } },
			ITEM: { canPickUp: false, canPurchase: false },
			SIGN: { displayName: 'Sign'},
			SLEEPINGBAG: { displayName: 'Sleeping Bag',
				description: 'A basic sleeping system. It works, but you won\'t feel totally refreshed after sleeping here.' },
			WATER: { displayName: function(f){ return f.waterType.displayName; } }
		};
		modData.types.fish = {
			BLUEGILL: { level: 0, displayName: 'Bluegill', methods: [fishingMethods.ROD], favoriteBaits: [baitTypes.WORM], peakTime: 6, spring: 50, summer: 35, fall: 10, winter: 5 },
			CATFISH: { level: 0, displayName: 'Catfish', methods: [fishingMethods.ROD], favoriteBaits: [baitTypes.WORM], peakTime: 6, spring: 35, summer: 25, fall: 35, winter: 5 },
			CRAYFISH: { level: 0, displayName: 'Crayfish', methods: [fishingMethods.POT, fishingMethods.ROD], favoriteBaits: [baitTypes.RICH], peakTime: 24, spring: 5, summer: 90, fall: 5, winter: 0 },
			FATHEAD: { level: 0, displayName: 'Fathead Minnow', methods: [fishingMethods.TRAP], favoriteBaits: [baitTypes.STINKY], peakTime: 18, spring: 10, summer: 70, fall: 10, winter: 10 }
		};
		modData.types.forageables = {
			BLACKBERRY: {displayName: 'Blackberry Bush', description: 'A wild blackberry bush riddled with sharp thorns. In the summer, this bush is lush with dark, sweet, berries.', item: modData.items.BLACKBERRY, minQuantity: 20, maxQuantity: 40, conditions: [function(){return calendarState.season == seasons.SUMMER;}]}
		};
		modData.types.hairColors = {
			AUBURN: {displayName: 'auburn'},
			BLACK: {displayName: 'black'},
			BLONDE: {displayName: 'blonde'},
			BROWN: {displayName: 'brown'},
			GREY: {displayName: 'grey'},
			RED: {displayName: 'red'},
			WHITE: {displayName: 'white'},
			BLUE: {displayName: 'blue'},
			GREEN: {displayName: 'green'},
			PINK: {displayName: 'pink'},
			PURPLE: {displayName: 'purple'}
		};
		modData.types.hairColorsNatural = [
			'AUBURN',
			'BLACK',
			'BLONDE',
			'BROWN',
			'GREY',
			'RED',
			'WHITE'
		];
		modData.types.hairStyles = {
			AFRO: {displayName: 'afro'},
			BOB: {displayName: 'bob cut'},
			BUN: {displayName: 'bun'},
			CREW: {displayName: 'crew cut'},
			FLAT: {displayName: 'flat top'},
			MANBUN: {displayName: 'man-bun'},
			MOHAWK: {displayName: 'mohawk'},
			PIGTAIL: {displayName: 'pigtails'},
			PONYLOW: {displayName: 'low pony'},
			PONYHIGH: {displayName: 'high pony'},
			PONYUNDER: {displayName: 'undercut pony'},
			SPACEBUNS: {displayName: 'space buns'}
		};
		modData.types.heights = {
			TALL: {displayName: 'tall'},
			AVERAGE: {displayName: 'average'},
			SHORT: {displayName: 'short'}
		};
		modData.types.structures = {
			...modData.types.structures,
			SHOP: { enterAction: 'Enter %%', exitAction: 'Leave %%', isLocked: function() { return !between(calendarState.minutes, hm(8, 59), hm(17), false); } },
			TENT: { level: 1, displayName: 'Tent' },
			HUT: { level: 2, displayName: 'Hut' },
			SHACK: { level: 3, displayName: 'Shack' },
			HOVEL: { level: 4, displayName: 'Hovel' },
			BUNG: { level: 5, displayName: 'Bungalow' },
			COTTAGE: { level: 6, displayName: 'Cottage' },
			HOUSE: { level: 7, displayName: 'House' },
			ESTATE: { level: 8, displayName: 'Estate' },
			VILLA: { level: 9, displayName: 'Villa' },
			MANSION: { level: 10, displayName: 'Mansion' },
			PALACE: { level: 11, displayName: 'Palace' }
		};
		modData.types.waters = {
			POND: { level: 1, displayName: 'Pond' }
		};
	</script>
	<script> // recipes
		//newRecipe (id, displayName, action, ingredients, result, time)
		//TODO add cookingFeatures list to each recipe
		newRecipe('BREAD_CAMPFIRE', 'campfire bread', 'Bake Bread', [newItemStack('DOUGH_BASIC', 0, 1)], newItemStack('BREAD_CAMPFIRE', 0, 1), 30);
		newRecipe('DOUGH_BASIC', 'basic dough', 'Knead Dough', [newItemStack('FLOUR_WHEAT', 0, 1), newItemStack('YEAST', 0, 1)], newItemStack('DOUGH_BASIC', 0, 1), 30);
		newRecipe('KABOB_STEAK', 'steak kabob', 'Roast Kabob', [newItemStack('BEEF', 0, 1)], newItemStack('KABOB_STEAK', 0, 1), 10);
		newRecipe('MARSHMALLOW_ROASTED', 'roasted marshmallow', 'Roast Marshmallow', [newItemStack('MARSHMALLOW', 0, 1)], newItemStack('MARSHMALLOW_ROASTED', 0, 1), 2);
		newRecipe('BURGER_RUSTIC', 'rustic burger', 'Assemble Burger', [newItemStack('BREAD_CAMPFIRE', 0, 1), newItemStack('KABOB_STEAK', 0, 1)], newItemStack('BURGER_RUSTIC', 0, 1), 2);
	</script>
	<script> // areas
		// newArea(id, name, feats, exits, onEnter)
		newArea(
			'HOMEPROP', 'Home Property',
			[
				newFeature('DEBRIS', 1),
				newFeature('DEBRIS', 2),
				newFeature('DEBRIS', 3),
				newFeature('DEBRIS', 4)
			],
			[
				newExit(directions.EAST, 'Old Farm rd', 'East on Old Farm road', 'OLDFARMRDW', 5, 0, null),
				newExit(directions.SOUTH, '%HOMEPROPNAME% Farm', 'South to %HOMEPROPNAME% Farm', 'HOMEFARM', 5, 0, function() {return !areaHasFeatureType(characterState.currentArea, 'DEBRIS');})
			],
			'Welcome Home!'
		),
		newArea(
			'HOMEFARM', '%HOMEPROPNAME% Farm',
			[
				newFeature('DEBRIS', 3),
				newFeature('DEBRIS', 4),
				newFeature('WATER', 0, {waterType: modData.types.waters.POND, noDelete: true, description: 'A nice-sized pond. You remember swimming here as a child. Maybe there are still fish here.'}),
				newFeature('ITEM', 0, {displayName: 'Rusty Shovel', description: 'Someone left an old shovel here. It could come in handy.', actions: [ { actionFunction: function(){clickActionButton(this, pickupTool);}, text: 'Take', accessibleText: 'Take Rusty Shovel', attr: {tool: 'shovel', level: 1} }] })
			],
			[
				newExit(directions.NORTH, '%HOMEPROPNAME%', 'North to %HOMEPROPNAME%', 'HOMEPROP', 5, 0, null)
			],
			'' 
		),
		newArea(
			'OLDFARMRDW', 'Old Farm Rd West',
			[
				newFeature('FORAGE', 0, {...modData.types.forageables.BLACKBERRY})
			],
			[
				newExit(directions.WEST, '%HOMEPROPNAME%', 'West to %HOMEPROPNAME%', 'HOMEPROP', 5, 0, null),
				newExit(directions.EAST, 'Old Farm rd', 'East on Old Farm road', 'OLDFARMRDE', 20, 0, null)
			],
			function(args) {
				var r = 'West end of Old Farm Road.';
				if (args !== null && args !== undefined)
				{
					switch (invDir(args.fromExit.direction))
					{
						case directions.WEST:
							r += ' Looks like it isn\'t well travelled.';
							break;
						case directions.EAST:
							r += ' You can see your family\'s old property from here.';
							break;
					}
				}
				return r;
			}
		),
		newArea(
			'OLDFARMRDE', 'Old Farm Rd East',
			[],
			[
				newExit(directions.WEST, 'Old Farm rd', 'West on Old Farm road', 'OLDFARMRDW', 20, 0, null),
				newExit(directions.EAST, 'Smalltown', 'East to Smalltown', 'STOWN_W', 5, 0, null),
				newExit(directions.SOUTH, 'Ranch Rd', 'South on Ranch Rd', 'RANCHRDN', 20, 0, null)
			],
			function(args) {
				var r = 'East end of Old Farm Road.';
				if (args !== null && args !== undefined)
				{
					switch (invDir(args.fromExit.direction))
					{
						case directions.WEST:
							r += ' You can see Smalltown at the end of the road.';
							break;
					}
				}
				return r;
			}
		),
		newArea(
			'RANCHRDN', 'Ranch rd North',
			[],
			[
				newExit(directions.NORTH, 'Old Farm rd', 'North to Old Farm Rd East', 'OLDFARMRDE', 20, 0, null),
				newExit(directions.SOUTH, 'Ranch Rd', 'South on Ranch Road', 'RANCHRDS', 20, 0, null)
			],
			'Ranch Road North'
		),
		newArea(
			'RANCHRDS', 'Ranch rd South',
			[],
			[
				newExit(directions.NORTH, 'Ranch Rd', 'North on Ranch Road', 'RANCHRDN', 20, 0, null),
				newExit(directions.WEST, 'Emma\'s Ranch', 'West to Emma\'s Ranch', 'EMMARANCH', 10, 0, null)
			],
			'Ranch Road South'
		),
		newArea(
			'EMMARANCH', 'Emma\'s Ranch',
			[],
			[
				newExit(directions.EAST, 'Ranch Rd', 'East to Ranch Road', 'RANCHRDS', 10, 0, null)
			],
			'Emma\'s Ranch, you can buy live stock and other ranching goods here.'
		),
		newArea(
			'STOWN_PL', 'Smalltown Plaza',
			[
				newFeature('SIGN', 0, {displayName: 'Plaza Guide', text: [UP_ARROW + ' North to Smalltown Jr. College', LEFT_ARROW + ' West to Old Farm Road', DOWN_ARROW + ' South to Shell Beach']}),
				newFeature('ITEM', 0, {displayName: 'Fountain', description: 'A large, marble fountain.',
					actions: [{ actionFunction: function(){
													if (testMoney(1, DEFAULT_MONEY_MESSAGE, true))
													{
														addAlertNarration('Ploop.');
														if (characterState.boon < 1) { addBoon(); }
													}
												},
						text: 'Toss a coin', accessibleText: 'Toss a coin into the fountain' }] })
			],
			[
				newExit(directions.NORTH, 'Smalltown North', 'North to Smalltown North', 'STOWN_N', 5, 0, null),
				newExit(directions.EAST, 'Smalltown East', 'East to Smalltown East', 'STOWN_E', 5, 0, null),
				newExit(directions.SOUTH, 'Smalltown South', 'South to Smalltown South', 'STOWN_S', 5, 0, null),
				newExit(directions.WEST, 'Smalltown West', 'West to Smalltown West', 'STOWN_W', 5, 0, null)
			],
			'Smalltown Plaza, the town center, where the action is. Check the Plaza Guide for directions.'
		),
		newArea(
			'STOWN_N', 'Smalltown North',
			[],
			[
				newExit(directions.EAST, 'Smalltown JC', 'East to Smalltown junior college', 'STOWN_JC', 5, 0, null),
				newExit(directions.SOUTH, 'Smalltown Plaza', 'South to Smalltown Plaza', 'STOWN_PL', 5, 0, null),
				newExit(directions.WEST, 'Cottage Rd', 'West on Cottage Road', 'STOWN_RES1', 5, 0, null)
			],
			'The northern edge of Smalltown'
		),
		newArea(
			'STOWN_E', 'Smalltown East',
			[],
			[
				newExit(directions.WEST, 'Smalltown Plaza', 'East to Smalltown Plaza', 'STOWN_PL', 5, 0, null)
			],
			'The eastern edge of Smalltown'
		),
		newArea(
			'STOWN_S', 'Smalltown South',
			[],
			[
				newExit(directions.NORTH, 'Smalltown Plaza', 'North to Smalltown Plaza', 'STOWN_PL', 5, 0, null),
				newExit(directions.SOUTH, 'Shell Beach', 'South to Shell Beach', 'STOWN_B', 5, 0, null)
			],
			function(args) {
				var r = 'The southern edge of Smalltown.';
				if (args !== null && args !== undefined)
				{
					switch (invDir(args.fromExit.direction))
					{
						case directions.NORTH:
							r += ' Shell Beach is to the south.';
							break;
					}
				}
				return r;
			}
		),
		newArea(
			'STOWN_W', 'Smalltown West',
			[],
			[
				newExit(directions.WEST, 'Old Farm rd', 'West to Old Farm road', 'OLDFARMRDE', 5, 0, null),
				newExit(directions.EAST, 'Smalltown Plaza', 'East to Smalltown Plaza', 'STOWN_PL', 5, 0, null)
			],
			'The western edge of Smalltown'
		),
		newArea(
			'STOWN_B', 'Shell Beach',
			[],
			[
				newExit(directions.NORTH, 'Smalltown South', 'North to Smalltown South', 'STOWN_S', 5, 0, null),
				newExit(directions.SOUTH, 'Pelican Pier', 'South to Pelican Pier', 'STOWN_D', 5, 0, null)
			],
			function(args) {
				var r = 'Shell Beach.';
				if (args !== null && args !== undefined)
				{
					switch (invDir(args.fromExit.direction))
					{
						case directions.NORTH:
							r += ' Lots of sand, waves and pelicans.';
							break;
						case directions.SOUTH:
							r += ' Smalltown South is to the north.';
							break;
					}
				}
				return r;
			}
		),
		newArea(
			'STOWN_D', 'Pelican Pier',
			[],
			[
				newExit(directions.NORTH, 'Shell Beach', 'North to Shell Beach', 'STOWN_B', 5, 0, null)
			],
			'Pelican Pier, where most of Smalltown\'s fisherman spend their mornings.'
		),
		newArea(
			'STOWN_JC', 'Smalltown Jr. College',
			[],
			[
				newExit(directions.WEST, 'Smalltown North', 'West to Smalltown North', 'STOWN_N', 5, 0, null)
			],
			'Smalltown junior college, where Smalltown\'s youth get ready for the working force.'
		),
		newArea(
			'STOWN_RES1', 'Cottage Rd',
			[],
			[
				newExit(directions.EAST, 'Smalltown North', 'East to Smalltown North', 'STOWN_N', 5, 0, null)
			],
			'Cottage Road, several Smalltown residents live on this street.'
		);
	</script>
	<script> // structures
		//"Fanciful Feldecarb Fountain flows full as fluttering fairies frolic fastidiously.  Flick a farthing?" 
			//function newStructure(areaId, type, area, owner, value, locked, amenities, options)
		newStructure('HOMESHACK', 'SHACK', 'HOMEPROP', null, 100, false,
					[
						newFeature('ITEM', 0, {canPickUp: true, canPurchase: false, itemStack: newItemStack('POT_OLD', 0, 1), onPickup: function(){ startQuest('COOKING_I'); }}),
						newFeature('CAMPFIRE', 0),
						newFeature('SLEEPINGBAG', 0)
					],
					{ displayName: 'An old dilapidated shack',
						description: 'It looks like a squatter was living here. They left an old ratty sleeping bag and the remnants of a campfire.' }
		);
		newStructure('GARDENSHOP', 'SHOP', 'STOWN_PL', null, 1000000, null,
					[
						newFeature('ITEM', 0, {itemStack: newItemStack(modData.items.SPINACH_SEED, 0, 1), canPickUp: false, canPurchase: true, conditions: function() {return (calendarState.season === seasons.SPRING);} })
					],
					{ displayName: 'Avery\'s H&G',
						description: 'Avery\'s Home & Garden stocks seasonal seeds and general garden goods.' }
		);
		newStructure('DOMSBAKERY', 'SHOP', 'STOWN_PL', 'dominic', 1000000, null,
					[],
					{ displayName: 'BPS Bakery',
						description: 'The Bread Poet\'s Society, bakery and coffee shop. Open mic on thursday nights.' }
		);
		newStructure('CLAYSDELI', 'SHOP', 'STOWN_PL', 'clayton', 1000000, null,
					[],
					{ displayName: 'M&G Deli',
						description: 'Meat and Greet delicatessen. Get your meats and other foods here.' }
		).isLocked = function() { return !between(calendarState.minutes, hm(7, 59), hm(16), false); };
		newStructure('GORDOSREST', 'SHOP', 'STOWN_E', 'luigi', 1000000, null,
					[],
					{ displayName: 'D\'Graisse\'s',
						description: 'Smalltowns own fine dining establishment. Very good reviews online.' }
		);
		newStructure('EMMASSHOP', 'SHOP', 'EMMARANCH', null, 2000000, null,
					[],
					{ displayName: 'Emma\'s Feed',
						description: 'Emma\'s Feed carries livestock, feed and ranching goods.' }
		).isLocked = function() { return !between(calendarState.minutes, hm(7, 59), hm(16), false); };
		newStructure('EMMAS_HOUSE', 'HOUSE', 'EMMARANCH', null, 1000000, true,
					[],
					{ noDelete: false, description: 'Emma\'s house.' }
		);
		newStructure('EMMARANCH_STAFF', 'BUNG', 'EMMARANCH', null, 10000, true,
					[],
					{ noDelete: false, description: 'On-site living for ranch hands.' }
		);
		newStructure('MARTIN_HOUSE', 'COTTAGE', 'STOWN_RES1', null, 250000, true,
					[],
					{ noDelete: false, description: 'The Martin Residence.' }
		);
	</script>
	<script> // npcs
		// newNpc(firstName, lastName, age, sex, description, appearance, schedule)
		// newCharacterAppearance(height, bodyType, natHair, curHair, hairStyle, eyes, aesthetic)
		// newNpcSchedule(area, activity, conditions)
		// weekdays[0] == monday
		function newNPCWorkSchedule(area)
		{
			return newNpcSchedule(area, 'WORKING', [function(){ return isStructureOpen(area);}]);
		}
	</script>
	<script> // NPC: Avery
		function avery()
		{
			var avery = newNpc('Avery', 'Thompson', 29, 0,
				'A edgy extrovert that is totes obsessed with plants and crystals.',
				newCharacterAppearance(modData.types.heights.AVERAGE, modData.types.bodies.AVERAGE, modData.types.hairColors.BLONDE, modData.types.hairColors.BLUE, modData.types.hairStyles.SPACEBUNS, modData.types.eyeColors.HAZEL, modData.types.aesthetics.ALT),
				[
					newNPCWorkSchedule('STOWN_PL_struct_GARDENSHOP')
				]
			);
		}
	</script>
	<script> // NPC: Clayton
		function clayton()
		{
			var clayton = newNpc('Clayton', 'Lespool', 46, 1,
				'A boisterous, friendly, guy with a salt-and-pepper beard. Likes to joke around and make friends. Loves a good pun.',
				newCharacterAppearance(modData.types.heights.TALL, modData.types.bodies.FIT, modData.types.hairColors.GREY, modData.types.hairColors.GREY, modData.types.hairStyles.PONYLOW, modData.types.eyeColors.BROWN, modData.types.aesthetics.CASUAL),
				[
					newNPCWorkSchedule('STOWN_PL_struct_CLAYSDELI'),
					newNpcSchedule('STOWN_PL', 'CHILLING', [function(){ return !isStructureOpen('STOWN_PL_struct_CLAYSDELI'); }])
				]);
			clayton.dialog = [
				newNpcDialog('Hey there I haven\'t seen you around before. I\'m Clay, the butcher. KNIFE to MEAT YOU!! HAHAHA! Get it? KNIFE? MEAT? Because I\'m the butcher! HAHAHA! Anyway, stop on by the deli some time, it\'s in the Smalltown Plaza.', null,
					[function(){ return (isStructureOwnedBy('STOWN_PL_struct_CLAYSDELI', 'clayton')
									&& !isStructureOpen('STOWN_PL_struct_CLAYSDELI')
									&& getNpcByName('clayton').conversationsToDate < 1); }]
				),
				
				// quest helpers
				newNpcDialog(
						'Hey I like the CUT of your jib, kid. '
						+ 'I feel like you have the GUTS to be a great butcher. '
						+ 'I just bought a new cleaver, you can have my old one.'
					, null,
					[function(){ return (isStructureOwnedBy('STOWN_PL_struct_CLAYSDELI', 'clayton')
									&& isStructureOpen('STOWN_PL_struct_CLAYSDELI')
									&& isCharacterOnQuest('COOKING_I')
									&& getInventoryItem('CLEAVER').quantity < 1
									&& getNpcByName('clayton').conversationsToDate > 1); }],
					function() {
							tryAddItemWithMessage('CLEAVER', 0, 1);
							addNpcDialogNarration(getNpcByName('clayton'), 'Come back when you have a complete cooking set, and I\'ll show you a few things.');
						}
				),
				newNpcDialog(
						'So, you\'ve got a set of knives now eh? You\'re a CUT above the rest, HAHAHA! '
					, null,
					[function(){ return (isCharacterOnQuest('COOKING_II')
									&& getNpcByName('clayton').conversationsToday < 1); }],
					function() {
							if (testTime(30, false, false))
							{
								addNpcDialogNarration(getNpcByName('clayton'), 'I\'ll show you how to make a steak kabob!');
								learnRecipe(characterState, 'KABOB_STEAK', true);
								tryAddItemWithMessage('BEEF', 0, 1);
								addTime(30);
							}
							else
							{
								addNpcDialogNarration(getNpcByName('clayton'), 'It\'s late, but come back when you have more time. I\'ll show you how to make a basic dough.');
							}
						}
				),

				// work talk
				newNpcDialog('Welcome to Meat and Greet! You can call me Clay, KNIFE to MEAT YOU! HAHAHA! Get it? KNIFE? MEAT? Because I\'m the butcher! HAHAHA!', null,
					[function(){ return (isStructureOwnedBy('STOWN_PL_struct_CLAYSDELI', 'clayton')
									&& isStructureOpen('STOWN_PL_struct_CLAYSDELI')
									&& getNpcByName('clayton').conversationsToDate < 1); }]
				),
				newNpcDialog([
						'Howdy, take a look around, I\'ve got all the choice cuts.',
						'You need some haggis, or some tripe? I\'ve got it all! HAHAHA!'
					], null,
					[function(){ return (isStructureOwnedBy('STOWN_PL_struct_DOMSBAKERY', 'dominic')
									&& isStructureOpen('STOWN_PL_struct_DOMSBAKERY')); }]
				)
			];
		}
	</script>
	<script> // NPC: Dominic
		function dominic()
		{
			var dominic = newNpc('Dominic', 'Smith', 34, 1,
				'Slender European hipster with a goatee and a love of sourdough bread.',
				newCharacterAppearance(modData.types.heights.AVERAGE, modData.types.bodies.THIN, modData.types.hairColors.BROWN, modData.types.hairColors.BROWN, modData.types.hairStyles.MANBUN, modData.types.eyeColors.BLUE, modData.types.aesthetics.HIPSTER),
				[
					newNPCWorkSchedule('STOWN_PL_struct_DOMSBAKERY'),
					newNpcSchedule('STOWN_PL', 'CHILLING', [function(){ return !isStructureOpen('STOWN_PL_struct_DOMSBAKERY'); }])
				]
			);
			dominic.dialog = [
				newNpcDialog('Hey you\'re new in town, you should come by my bakery sometime. It\'s the Bread Poet\'s Society in the Smalltown Plaza.', null,
					[function(){ return (isStructureOwnedBy('STOWN_PL_struct_DOMSBAKERY', 'dominic')
									&& !isStructureOpen('STOWN_PL_struct_DOMSBAKERY')
									&& getNpcByName('dominic').conversationsToDate < 1); }]
				),
				
				// quest helpers
				newNpcDialog(
						'You look like you have the spirit of a great baker inside you. '
						+ 'I smell yeast running through your veins. Here, take this breadknife. '
						+ 'I was going to throw it out anyway, but it can help you on your way to becoming a great baker.'
					, null,
					[function(){ return (isStructureOwnedBy('STOWN_PL_struct_DOMSBAKERY', 'dominic')
									&& isStructureOpen('STOWN_PL_struct_DOMSBAKERY')
									&& isCharacterOnQuest('COOKING_I')
									&& getInventoryItem('BREADKNIFE').quantity < 1
									&& getNpcByName('dominic').conversationsToDate > 1); }],
					function() {
							tryAddItemWithMessage('BREADKNIFE', 0, 1);
							addNpcDialogNarration(getNpcByName('dominic'), 'Come back once you have a cooking set and I\'ll show you an easy dough recipe.');
						}
				),
				newNpcDialog(
						'Looks like you\'ve got your cooking set together. Great! '
					, null,
					[function(){ return (isCharacterOnQuest('COOKING_II')
									&& getNpcByName('dominic').conversationsToday < 1); }],
					function() {
							if (testTime(30, false, false))
							{
								addNpcDialogNarration(getNpcByName('dominic'), 'I\'ll show you how to make a basic dough.');
								learnRecipe(characterState, 'DOUGH_BASIC', true);
								tryAddItemWithMessage('YEAST', 0, 1);
								tryAddItemWithMessage('FLOUR_WHEAT', 0, 1);
								addTime(30);
							}
							else
							{
								addNpcDialogNarration(getNpcByName('dominic'), 'It\'s late, but come back when you have more time. I\'ll show you how to make a basic dough.');
							}
						}
				),

				// work talk
				newNpcDialog('Hey welcome to my bakery. I haven\'t seen you around before.', null,
					[function(){ return (isStructureOwnedBy('STOWN_PL_struct_DOMSBAKERY', 'dominic')
									&& isStructureOpen('STOWN_PL_struct_DOMSBAKERY')
									&& getNpcByName('dominic').conversationsToDate < 1); }]
				),
				newNpcDialog([
						'Hey there, feel free to look around, I\'ve got lots of goodies.',
						'I specialize in sourdough breads. Why not take a loaf home?'
					], null,
					[function(){ return (isStructureOwnedBy('STOWN_PL_struct_DOMSBAKERY', 'dominic')
									&& isStructureOpen('STOWN_PL_struct_DOMSBAKERY')); }]
				)
			];
		}
	</script>
	<script> // NPC: Emma
		function emma()
		{
			var emma = newNpc('Emma', 'Brown', 25, 0,
				'A bubbly young lass who dresses in rustic western apparel.',
				newCharacterAppearance(modData.types.heights.AVERAGE, modData.types.bodies.CURVY, modData.types.hairColors.BLONDE, modData.types.hairColors.BLONDE, modData.types.hairStyles.PONYHIGH, modData.types.eyeColors.BLUE, modData.types.aesthetics.RUSTIC),
				[
					newNPCWorkSchedule('EMMARANCH_struct_EMMASSHOP'),
					newNpcSchedule('EMMAS_HOUSE', 'SLEEPING', [function(){ return !isStructureOpen('EMMARANCH_struct_EMMASSHOP'); }])
				]
			);
		}
	</script>
	<script> // NPC: Liam
		function liam()
		{
			var liam = newNpc('Liam', 'O\'Doyle', 26, 1,
				'A fiery ginger who likes to live life on the edge.',
				newCharacterAppearance(modData.types.heights.AVERAGE, modData.types.bodies.AVERAGE, modData.types.hairColors.RED, modData.types.hairColors.RED, modData.types.hairStyles.CREW, modData.types.eyeColors.GREEN, modData.types.aesthetics.CASUAL),
				[
					newNpcSchedule('STOWN_PL', 'CHILLING', [function(){ return timeBetween(6*60, 18*60); }])
				]);
		}
	</script>
	<script> // NPC: Luigi
		function luigi()
		{
			var luigi = newNpc('Luigi', 'D\'Graisse', 30, 1,
				'A loud, obnoxious, chef with a monstrous ego, but the skills to back it up.',
				newCharacterAppearance(modData.types.heights.AVERAGE, modData.types.bodies.DADBOD, modData.types.hairColors.BLONDE, modData.types.hairColors.BLONDE, modData.types.hairStyles.CREW, modData.types.eyeColors.BLUE, modData.types.aesthetics.CASUAL),
				[
					newNPCWorkSchedule('STOWN_E_struct_GORDOSREST'),
					newNpcSchedule('STOWN_E', 'CHILLING', [function(){ return !isStructureOpen('STOWN_E_struct_GORDOSREST'); }])
				]);
			luigi.dialog = [
				newNpcDialog('Hey! Who are you? You never heard of Luigi D\'Graisse eh? If you want to taste some real food, come by my restaurant on the east side of town.', null,
					[function(){ return (isStructureOwnedBy('STOWN_E_struct_GORDOSREST', 'luigi')
									&& !isStructureOpen('STOWN_E_struct_GORDOSREST')
									&& getNpcByName('luigi').conversationsToDate < 1); }]
				),
				
				// quest helpers
				newNpcDialog(
						'I\'m too busy for you, go away!'
					, null,
					[function(){ return (isStructureOwnedBy('STOWN_E_struct_GORDOSREST', 'luigi')
									&& isStructureOpen('STOWN_E_struct_GORDOSREST')
									&& isCharacterOnQuest('COOKING_I')
									&& getInventoryItem('CHEFSKNIFE').quantity < 1
									&& getNpcByName('luigi').conversationsToDate > 1); }],
					function() {
							addAlertNarration('Luigi throws a chef\'s knife at you and it sticks into the wall.');
							tryAddItemWithMessage('CHEFSKNIFE', 0, 1);
							addNpcDialogNarration(getNpcByName('luigi'), 'Now scram!');
						}
				),

				// work talk
				newNpcDialog('You decided to experience culinary perfection, I see. Well sit down and order something!', null,
					[function(){ return (isStructureOwnedBy('STOWN_E_struct_GORDOSREST', 'luigi')
									&& isStructureOpen('STOWN_E_struct_GORDOSREST')
									&& getNpcByName('luigi').conversationsToDate < 1); }]
				)
			];
		}
	</script>
	<script> // NPC: Mateo
		function mateo()
		{
			var mateo = newNpc('Mateo', 'Gonzalez', 23, 1,
				'A quiet, hardworking fellow.',
				newCharacterAppearance(modData.types.heights.AVERAGE, modData.types.bodies.AVERAGE, modData.types.hairColors.BROWN, modData.types.hairColors.BROWN, modData.types.hairStyles.CREW, modData.types.eyeColors.BROWN, modData.types.aesthetics.RUSTIC),
				[
					newNpcSchedule('EMMARANCH_STAFF', 'SLEEPING', [function(){ return !timeBetween(5*60, 13*60); }]),
					newNpcSchedule('EMMARANCH', 'WORKING', [function(){ return !isDayOfWeek(['SA', 'SU']) && timeBetween(5*60, 13*60); }])
				],
				[modData.types.bodies.CURVY]);
		}
	</script>
	<script> // NPC: Olivia
		function olivia()
		{
			var olivia = newNpc('Olivia', 'Martin',
				22, 0, 'A short demure girl, with bangs and glasses. She\'d rather stay at home with her cat than go to parties.',
				newCharacterAppearance(modData.types.heights.SHORT, modData.types.bodies.THIN, modData.types.hairColors.BLONDE, modData.types.hairColors.BLACK, modData.types.hairStyles.BOB, modData.types.eyeColors.BLUE, modData.types.aesthetics.ALT),
				[
					// sleeping
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'SLEEPING', [function(){ return isDayOfWeek(['MO', 'TU', 'WE']) && !timeBetween(hm(7, 30), hm(21, 30)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'SLEEPING', [function(){ return isDayOfWeek(['TH']) && !timeBetween(hm(7, 30), hm(24)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'SLEEPING', [function(){ return isDayOfWeek(['FR', 'SA']) && !timeBetween(hm(9), hm(24)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'SLEEPING', [function(){ return isDayOfWeek(['SU']) && !timeBetween(hm(9), hm(21)); }]),
					
					// school days
					newNpcSchedule('STOWN_RES1', 'WALKING_E', [function(){ return isDayOfWeek(['MO', 'TU', 'WE', 'TH']) && timeBetween(hm(7, 31), hm(7, 40)); }]),
					newNpcSchedule('STOWN_N', 'WALKING_E', [function(){ return isDayOfWeek(['MO', 'TU', 'WE', 'TH']) && timeBetween(hm(7, 41), hm(7, 50)); }]),
					newNpcSchedule('STOWN_JC', 'STUDYING', [function(){ return isDayOfWeek(['MO', 'TU', 'WE', 'TH']) && timeBetween(hm(7, 51), hm(12, 0)); }]),
					newNpcSchedule('STOWN_JC', 'WALKING_W', [function(){ return isDayOfWeek(['MO', 'TU', 'WE', 'TH']) && timeBetween(hm(12, 1), hm(12, 10)); }]),
					
					// Monday after school
					newNpcSchedule('STOWN_N', 'WALKING_W', [function(){ return isDayOfWeek(['MO']) && timeBetween(hm(12, 11), hm(12, 20)); }]),
					newNpcSchedule('STOWN_RES1', 'HOME', [function(){ return isDayOfWeek(['MO']) && timeBetween(hm(12, 21), hm(12, 30)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'STUDYING', [function(){ return isDayOfWeek(['MO']) && timeBetween(hm(12, 31), hm(17)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'READING', [function(){ return isDayOfWeek(['MO']) && timeBetween(hm(17, 1), hm(20)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'CHILLING', [function(){ return isDayOfWeek(['MO']) && timeBetween(hm(20, 1), hm(21, 29)); }]),
					
					// work days after school
					newNpcSchedule('STOWN_N', 'WALKING_S', [function(){ return isDayOfWeek(['TU', 'WE', 'TH']) && timeBetween(hm(12, 11), hm(12, 20)); }]),
					newNpcSchedule('STOWN_PL', 'CHILLING', [function(){ return isDayOfWeek(['TU', 'WE', 'TH']) && timeBetween(hm(12, 21), hm(12, 45)); }]),
					newNpcSchedule('STOWN_PL_struct_DOMSBAKERY', 'CHILLING', [function(){ return isDayOfWeek(['TU', 'WE', 'TH']) && timeBetween(hm(12, 46), hm(12, 59)); }]),
					newNpcSchedule('STOWN_PL_struct_DOMSBAKERY', 'WORKING', [function(){ return isDayOfWeek(['TU', 'WE', 'TH']) && timeBetween(hm(13), hm(17)); }]),
					newNpcSchedule('STOWN_PL', 'WALKING_N', [function(){ return isDayOfWeek(['TU', 'WE', 'TH']) && timeBetween(hm(17, 1), hm(17, 10)); }]),
					newNpcSchedule('STOWN_N', 'WALKING_W', [function(){ return isDayOfWeek(['TU', 'WE', 'TH']) && timeBetween(hm(17, 11), hm(17, 20)); }]),
					newNpcSchedule('STOWN_RES1', 'HOME', [function(){ return isDayOfWeek(['TU', 'WE', 'TH']) && timeBetween(hm(17, 21), hm(17, 30)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'READING', [function(){ return isDayOfWeek(['TU', 'WE']) && timeBetween(hm(17, 31), hm(18)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'CHILLING', [function(){ return isDayOfWeek(['TU', 'WE']) && timeBetween(hm(18, 31), hm(21, 29)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'GAMING', [function(){ return isDayOfWeek(['TH']) && timeBetween(hm(17, 31), hm(23, 59)); }]),

					// weekends
					newNpcSchedule('STOWN_RES1', 'WALKING_E', [function(){ return isDayOfWeek(['FR', 'SA', 'SU']) && timeBetween(hm(9, 1), hm(9, 10)); }]),
					newNpcSchedule('STOWN_N', 'WALKING_S', [function(){ return isDayOfWeek(['FR', 'SA', 'SU']) && timeBetween(hm(9, 11), hm(9, 20)); }]),
					newNpcSchedule('STOWN_PL', 'CHILLING', [function(){ return isDayOfWeek(['FR', 'SA', 'SU']) && timeBetween(hm(9, 21), hm(9, 30)); }]),
					newNpcSchedule('STOWN_PL_struct_DOMSBAKERY', 'CHILLING', [function(){ return isDayOfWeek(['FR', 'SA', 'SU']) && timeBetween(hm(9, 31), hm(9, 40)); }]),
					newNpcSchedule('STOWN_PL_struct_DOMSBAKERY', 'READING', [function(){ return isDayOfWeek(['FR', 'SA', 'SU']) && timeBetween(hm(9, 41), hm(12)); }]),
					newNpcSchedule('STOWN_PL', 'WALKING_N', [function(){ return isDayOfWeek(['FR', 'SA', 'SU']) && timeBetween(hm(12, 1), hm(12, 10)); }]),
					newNpcSchedule('STOWN_N', 'WALKING_W', [function(){ return isDayOfWeek(['FR', 'SA', 'SU']) && timeBetween(hm(12, 11), hm(12, 20)); }]),
					newNpcSchedule('STOWN_RES1', 'HOME', [function(){ return isDayOfWeek(['FR', 'SA', 'SU']) && timeBetween(hm(12, 21), hm(12, 30)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'EATING', [function(){ return isDayOfWeek(['FR', 'SA', 'SU']) && timeBetween(hm(12, 31), hm(13)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'CHILLING', [function(){ return isDayOfWeek(['FR', 'SA', 'SU']) && timeBetween(hm(13, 1), hm(14)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'GAMING', [function(){ return isDayOfWeek(['FR', 'SA', 'SU']) && timeBetween(hm(14, 1), hm(17)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'READING', [function(){ return isDayOfWeek(['FR', 'SA']) && timeBetween(hm(17, 1), hm(23, 59)); }]),
					newNpcSchedule('STOWN_RES1_struct_MARTIN_HOUSE', 'READING', [function(){ return isDayOfWeek(['SU']) && timeBetween(hm(17, 1), hm(20, 59)); }]),
				],
				[modData.types.aesthetics.ALT, modData.types.bodies.AVERAGE, modData.types.eyeColors.GREEN]);
		}
	</script>
	<script> // npc calls
		avery();
		clayton();
		dominic();
		emma();
		liam();
		luigi();
		mateo();
		olivia();
	</script>
	<script> // quests
		// newQuest(id, name, description, rewards, triggers, conditions, onComplete)
		newQuest('COOKING_I', 'Commence Cooking I',
				'Collect a breadknife, a cleaver and a chef\'s knife to make a set.',
				'Beginner Knife Set',
				[questTriggers.GAININVENTORYITEM],
				[function(cs) {
						return (getInventoryItem('BREADKNIFE').quantity > 0
							&& getInventoryItem('CLEAVER').quantity > 0
							&& getInventoryItem('CHEFSKNIFE').quantity > 0);
					}],
				function(cs) {
						tryRemoveInventory('BREADKNIFE', 0, 1, true);
						tryRemoveInventory('CLEAVER', 0, 1, true);
						tryRemoveInventory('CHEFSKNIFE', 0, 1, true);
						tryRemoveInventory('POT_OLD', 0, 1, true);
						upgradeTool(cs, 'cookingSet', 1);
						addAlertNarration('Cooking Set added to tools.')
						addAlertNarration('You completed the Cooking Set. Now that you\'ve got it, maybe some of the locals will share some of their recipes.');
						startQuest('COOKING_II');
					});
		newQuest('COOKING_II', 'Commence Cooking II',
				'Talk to the local foodies and learn a few techniques.',
				'Level 1 Cooking Skill',
				[questTriggers.LEARNRECIPE],
				[function(cs) {
						return (characterKnowsRecipe(cs, 'KABOB_STEAK')
							&& characterKnowsRecipe(cs, 'DOUGH_BASIC'));
					}],
				function(cs) {
						addAlertNarration('You\'ve got the tools and a couple basic recipes, now you can begin your cooking career.')
						upgradeSkill(cs, 'cooking', 1, true);
						startQuest('COOKING_III');
					});
		newQuest('COOKING_III', 'Commence Cooking III',
				'Make a basic dough and cook a steak kabob.',
				'New Recipes',
				[questTriggers.COOKRECIPE],
				[function(cs) {
						return (characterHasCookedRecipe(cs, 'KABOB_STEAK') > 0
							&& characterHasCookedRecipe(cs, 'DOUGH_BASIC') > 0);
					}],
				function(cs) {
						addAlertNarration('By tinkering around with your cooking techniques, you\'ve unlocked a few recipes. Now you\'re on your own to learn the ways of the chef.')
						learnRecipe(cs, 'BREAD_CAMPFIRE', true);
						learnRecipe(cs, 'BURGER_RUSTIC', true);
						learnRecipe(cs, 'MARSHMALLOW_ROASTED', true);
					});
	</script>
	<script> // gameplay functions
		function createNewCharacter()
		{
			setSubcontent('gameBox', 'createNewCharacter');
			clearNarration();
			addNarrationMessage('Welcome to Smalltown.');
			addNarrationMessage('You\'ve inherrited a large property from your recently deceased relative and decided to uproot your whole life to live here.');
			addNarrationMessage('Tell me a little about yourself:');
		}
		function continueGame()
		{
			setSubcontent('gameBox', 'continueGame');
		}
		function loadNewWorld()
		{
			var name = g('yourNameInput').value;
			var prop = g('propNameInput').value;

			newGame(name);
			updatePropertyName('HOMEPROP', prop);
			characterState.appearance = newCharacterAppearance(
				modData.types.heights[g('heightInput').value],
				modData.types.bodies[g('bodyTypeInput').value],
				modData.types.hairColors[g('hairInput').value],
				modData.types.hairColors[g('hairInput').value],
				modData.types.hairStyles[g('hairStyleInput').value],
				modData.types.eyeColors[g('eyeInput').value],
				modData.types.aesthetics[g('aestheticInput').value]
			);
			
			characterState.health = 20;
			characterState.maxHealth = 20;
			characterState.stamina = 20;
			characterState.maxStamina = 20;
			characterState.money = 0;
			characterState.lastBedtime = 1440; // midnight
			characterState.ownedAreas.push('HOMEPROP');
			characterState.homeProperty = 'HOMEPROP';
			
			if (g('sexInputMale').checked) { characterState.sex = 1; }
			else { characterState.sex = 0; }
			
			startGame();
			setSubcontent('gameBox', 'main');
			setSubcontent('viewBox', 'currentArea');
			setCurrentArea(characterState.homeProperty, null);
			selectTab('tabBox', 'area', 'maintabs', g('mainTab_Area'));
		}
		
		function tryClearDebris(stamina, time, area, feature)
		{
			if (testStamina(stamina, staticMessages.NOT_ENOUGH_STAMINA, false))
			{
				if (testTime(time, true, true))
				{
					addAlertNarration('Debris cleared.' + ((time > 60) ? ' Whew!' : ''));
					addStamina(-stamina);
					deleteFeature(area, feature);
					if (!areaHasFeatureType(area, 'DEBRIS'))
					{
						addAlertNarration('All debris has been cleared! New features and paths may now be accessible.');
					}
				}
			}
		}
		function addBoon()
		{
			characterState.boon++;
		}
	</script>
	<script> // button handlers
		function clickClearDebrisButton(button)
		{
			var f = getFeature(button.getAttribute('data-feature'));
			tryClearDebris(f.level, 30*Math.pow(2, f.level-1), button.getAttribute('data-area'), button.getAttribute('data-feature'));
		}
		function clickEnterStructureButton(button)
		{
			tryEnterStructure(button.getAttribute('data-structure'));
		}
		function clickLeaveStructureButton(button)
		{
			tryLeaveStructure(button.getAttribute('data-toarea'));
		}
	</script>
	<script> // skill calc functions
		function getEarlyBirdMinutes()
		{
			var n = characterState.skills.earlyBird.level;
			return Math.max(1, Math.round((Math.pow(n, 2)+(n-1)) / 5 * 2.5));
		}
		function getNightOwlMinutes()
		{
			var n = characterState.skills.nightOwl.level;
			return Math.max(1, Math.round((Math.pow(n, 2)+(n-1)) / 5) * 5);
		}
		function getWakeUpTime()
		{
			// 6am
			return 360 - getEarlyBirdMinutes();
		}
		function getPassOutTime()
		{
			// minutes in a day (midnight)
			return 1440 + getNightOwlMinutes();
		}
		function getForagedBonusChance()
		{
			var n = characterState.skills.foraging.level;
			return n;
		}
		function getForagedBonusQuantity()
		{
			var n = characterState.skills.foraging.level;
			return Math.round(n / 2);
		}
		function getForagedItemQuantity(quantity)
		{
			var n = characterState.skills.foraging.level;
			return Math.round(quantity * (1 + (n * (100 / 15) / 100)));
		}
		function getCookingUpgradeChance(level)
		{
			return Math.max(0, characterState.skills.cooking.level - level) * 5;
		}
	</script>
	<script> // feature display functions
		function makeButton(className, action, buttonText, accessibleText, attr)
		{
			var b = ce('button');
			b.className = className;
			b.onclick = action;
			if (accessibleText !== null)
			{
				b.setAttribute('aria-label', handleWildcards(accessibleText));
				b.setAttribute('title', handleWildcards(accessibleText));
			}
			b.innerHTML = handleWildcards(buttonText);
			
			if (attr != null)
			{
				for (var key in attr)
				{
					b.setAttribute('data-' + key, attr[key]);
				}
			}
			return b;
		}
		function makeItemInspectbutton(item)
		{
			return makeButton('ochreButton', function(){inspectItem(this.getAttribute('data-itemid'));}, INSPECT_ICON, 'Inspect ' + item.displayName, {itemid: item.id});
		}
		function makeSkillInspectbutton(skill)
		{
			return makeButton('ochreButton', function(){inspectSkill(this.getAttribute('data-skillid'));}, INSPECT_ICON, 'Inspect ' + skill.displayName, {skillId: skill.id});
		}
		function handleFeatureRow(area, feat)
		{
			var row = null;
			if (feat.type == 'STRUCT_EXIT')
			{
				row = createFeatureRow(feat, { actionFunction: function(){clickActionButton(this, clickLeaveStructureButton);}, text: 'Exit', accessibleText: 'Exit', attr: { toArea: feat.toArea } });
			}			
			else
			{
				if (areaHasFeatureType(area, 'DEBRIS'))
				{
					switch (feat.type)
					{
						case 'DEBRIS':
							row = createFeatureRow(feat, { actionFunction: function(){clickActionButton(this, clickClearDebrisButton);}, text: 'Clear Debris', accessibleText: 'Clear Debris', attr: { area: area.id, feature: feat.id } });
							break;
					}
				}
				else
				{
					var actions = [];
					switch (feat.type)
					{
						case 'FORAGE':
							// TODO reset foraging every week
							if (!worldState.foragedThisWeek.includes(feat.id))
							{
								actions.push({ actionFunction: function(){clickActionButton(this, clickForageButton);}, text: 'Forage', accessibleText: 'Forage from ' + getFeatureDisplayName(feat), attr: { area: area.id, feature: feat.id} });
							}
							break;
						case 'ITEM':
							if (feat.hasOwnProperty('actions'))
							{
								for (var key in feat.actions)
								{
									var act = feat.actions[key];
									actions.push({ actionFunction: act.actionFunction, text: act.text, accessibleText: act.accessibleText, attr: { area: area.id, feature: feat.id, ...act.attr} });
								}
							}
							if (feat.hasOwnProperty('canPickUp') && feat.canPickUp)
							{
								actions.push({ actionFunction: function(){clickActionButton(this, clickTakeItemButton);}, text: 'Take', accessibleText: 'Take ' + getFeatureDisplayName(feat), attr: { area: area.id, feature: feat.id, itemId: feat.itemStack.item, itemLevel: feat.itemStack.level, itemQuantity: feat.itemStack.quantity } });
							}
							break;
						case 'WATER':
							actions.push({ actionFunction: function(){clickActionButton(this, clickFishButton);}, text: 'Fish', accessibleText: 'Fish in ' + getFeatureDisplayName(feat), attr: { area: area.id, feature: feat.id } });
							break;
					}
					row = createFeatureRow(feat, actions);
				}
			}
			return row;
		}
		function createFeatureRow(feat, actions)
		{
			var row = ce('tr');
			var nameTd = ce('td');
			var actionTd = ce('td');
			nameTd.innerHTML = ucaseName(getFeatureDisplayName(feat));
			if (feat.type == 'ITEM' && feat.canPurchase && feat.hasOwnProperty('itemStack'))
			{
				var price = ce('span');
				price.innerHTML = ': $' + feat.itemStack.item.value;
				nameTd.appendChild(price);
			}
			if (feat.level > 0)
			{
				nameTd.appendChild(renderStars(feat.level, true));
			}			
			if (actions !== null && actions !== undefined)
			{
				if (Array.isArray(actions))
				{
					for (var i=0;i<actions.length;i++)
					{
						actionTd.appendChild(makeFeatureActionButton(actions[i].actionFunction, actions[i].text, actions[i].accessibleText, actions[i].attr));
					}
				}
				else
				{
					actionTd.appendChild(makeFeatureActionButton(actions.actionFunction, actions.text, actions.accessibleText, actions.attr));
				}
			}
			actionTd.appendChild(makeFeatureInspectbutton(feat));
			row.appendChild(nameTd);
			row.appendChild(actionTd);
			return row;
		}

		function makeFeatureActionButton(action, buttonText, accessibleText, attr)
		{
			return makeButton('ochreButton', action, buttonText, accessibleText, attr);
		}
		function makeFeatureInspectbutton(feat)
		{
			return makeButton('ochreButton', function(){inspectFeature(this);}, INSPECT_ICON, 'Inspect ' + getFeatureDisplayName(feat), {featureId: feat.id});
		}
		function makeStructureInspectbutton(struct)
		{
			return makeButton('ochreButton', function(){inspectStructure(this);}, INSPECT_ICON, 'Inspect ' + getFuncOrVar(struct.displayName), {structureId: struct.id});
		}
		function makeNpcInspectbutton(n)
		{
			return makeButton('ochreButton', function(){inspectNpc(this);}, INSPECT_ICON, 'Inspect ' + getFuncOrVar(n.firstName), {npcId: n.id});
		}
		
		function appendNarrationBox(message, className)
		{
			var nar = g('narrationBox');
			var p = ce('p');
			if (Array.isArray(message))
			{
				var t = [];
				for (var i=0;i<message.length;i++)
				{
					t.push(handleWildcards(message[i]))
				}
				p.innerHTML = t.join('<br />');
			}
			else { p.innerHTML = handleWildcards(message); }
			p.className = className;
			nar.appendChild(p);
		}
		function scrollNarrationToBottom()
		{
			var nar = g('narrationBox');
			nar.scrollTop = nar.scrollHeight;
		}
	</script>
	<script> // misc functions
		function getDebrisDescription(level)
		{
			var adjs = [...sizeLevels];
			var a = adjs[Math.min(level, adjs.length-1)];
			return 'A' + n(a) + ' ' + a + ' pile of debris. You\'ll have to clear this out before you can do any work or access any features here.';
		}
		function getNpcAttraction(npc, app)
		{
			var r = 0;
			var n = modData.npcs[npc];
			r += (n.personalPreferences.includes(app.bodyType)) ? 1 : 0;
			r += (n.personalPreferences.includes(app.aesthetic)) ? 1 : 0;
			r += (n.personalPreferences.includes(app.eyes)) ? 1 : 0;
			r += (n.personalPreferences.includes(app.currentHairColor)) ? 1 : 0;
			r += (n.personalPreferences.includes(app.hairStyle)) ? 1 : 0;
			r += (n.personalPreferences.includes(app.height)) ? 1 : 0;
			r += (n.personalPreferences.includes(attractors.DYED_HAIR) && app.currentHair != app.naturalHairColor) ? 1 : 0;
			
			return r;
		}
	</script>
	<script src="Smalltown_modHooks.js"></script> 
</head>
<body>
	<main role="main">
		<div id="gameBox" data-subcontent-type="layout" data-subcontent-default="block" data-subcontent="pregame" data-mode="normal">
			<h1>Smalltown v0.1a</h1>
			<div id="narrationBox" aria-live="assertive" role="alert"></div>
			<div id="controlsBox">
				<div id="layout-pregame" class="subcontent layout">
					<button id="continueButton" class="menuButton ochreButton" onclick="continueGame(false);"><span>Continue</span></button><br />
					<button id="newGameButton" class="menuButton greenButton" onclick="createNewCharacter(false);"><span>New Game</span></button><br />
				</div>
				<div id="layout-createNewCharacter" class="subcontent layout">
					<table style="text-align: left;">
						<tr><td>Your Name:</td><td><input type="text" id="yourNameInput" value="Bosco" /></td></tr>
						<tr><td>Property Name:</td><td><input type="text" id="propNameInput" value="Boss Manor" /></td></tr>
						<tr><td>Sex:</td><td><label for="sexInputMale"> Male:</label><input type="radio" id="sexInputMale" name="sexInput" checked /> <label for="sexInputFemale"> Female:</label><input type="radio" id="sexInputFemale" name="sexInput" /></td></tr>
						<tr><td>Height:</td><td><select id="heightInput"></select></td></tr>
						<tr><td>Body Type:</td><td><select id="bodyTypeInput"></select></td></tr>
						<tr><td>Hair Color:</td><td><select id="hairInput"></select></td></tr>
						<tr><td>Hair Style:</td><td><select id="hairStyleInput"></select></td></tr>
						<tr><td>Eye Color:</td><td><select id="eyeInput"></select></td></tr>
						<tr><td>Aesthetic:</td><td><select id="aestheticInput"></select></td></tr>
					</table>
					<button id="beginButton" class="menuButton greenButton" onclick="loadNewWorld();"><span>Begin New Life</span></button><br />
				</div>
				<div id="layout-continueGame" class="subcontent layout">
					<table>
						<thead>
							<tr>
								<th>Save Title</th>
								<th>Play Time</th>
								<th>Last Save Date</th>
							</tr>
						</thead>
						<tbody id="saveListBody">
						</tbody>
					</table>
				</div>
				<div id="layout-main" class="subcontent layout">
					<div id="viewBox" data-subcontent-type="view" data-subcontent-default="block" data-subcontent="currentArea">
						<div id="view-currentArea" class="subcontent view">
							<div>
								<h2>Navigation</h2>
								<div id="navigationButtons">
									<button id="northNavButton" class="navButton blueButton" aria-label="North" data-area="" data-exit="" onclick="clickActionButton(this, clickNavButton);">N: <span id="northNavButtonText"></span></button><br />
									<button id="westNavButton" class="navButton blueButton" aria-label="West" data-area="" data-exit="" onclick="clickActionButton(this, clickNavButton);">W: <span id="westNavButtonText"></span></button>
									<button id="eastNavButton" class="navButton blueButton" aria-label="East" data-area="" data-exit="" onclick="clickActionButton(this, clickNavButton);">E: <span id="eastNavButtonText"></span></button><br />
									<button id="southNavButton" class="navButton blueButton" aria-label="South" data-area="" data-exit="" onclick="clickActionButton(this, clickNavButton);">S: <span id="southNavButtonText"></span></button>
								</div>
							</div>
							<div id="tabBox" data-subcontent-type="tabcontent" data-subcontent-default="block" data-subcontent="area">
								<div class="tabcontrols" style="margin-bottom: 2vh;">
									<div id="mainTab_Area" class="tabcontrol maintabs" data-tabcontrolfor="tabcontent-area" onclick="selectTab('tabBox', 'area', 'maintabs', this);"><h4>Area</h4></div>
									<div id="mainTab_Inv" class="tabcontrol maintabs" data-tabcontrolfor="tabcontent-inventory" onclick="selectTab('tabBox', 'inventory', 'maintabs', this);"><h4>Inventory</h4></div>
									<div id="mainTab_Skill" class="tabcontrol maintabs" data-tabcontrolfor="tabcontent-skills" onclick="selectTab('tabBox', 'skills', 'maintabs', this);"><h4>Skills</h4></div>
									<div id="mainTab_Journal" class="tabcontrol maintabs" data-tabcontrolfor="tabcontent-journal" onclick="selectTab('tabBox', 'journal', 'maintabs', this);"><h4>Journal</h4></div>
									<div id="mainTab_Pref" class="tabcontrol maintabs" data-tabcontrolfor="tabcontent-preferences" onclick="selectTab('tabBox', 'preferences', 'maintabs', this);"><h4 class="placeholder" data-content="GEAR_ICON" aria-label="Preferences" aria-role="img" style="font-weight: bold; font-size: 1.2em; position: relative; top: -.75vh;"></h4></div>
								</div>
								<div id="tabcontent-area" class="subcontent tabcontent">
									<table id="areaTable" class="itemTable">
										<thead>
											<tr>
												<th>Area</th>
												<th>Actions</th>
											</tr>
										</thead>
										<tbody id="areaTableBody"></tbody>
									</table>
									<table id="areaNpcsTable" class="itemTable">
										<thead>
											<tr>
												<th>People</th>
												<th>Actions</th>
											</tr>
										</thead>
										<tbody id="areaNpcsBody"></tbody>
									</table>
									<table id="structuresTable" class="itemTable">
										<thead>
											<tr>
												<th>Structure</th>
												<th>Actions</th>
											</tr>
										</thead>
										<tbody id="areaStructuresBody"></tbody>
									</table>
									<table id="featuresTable" class="itemTable">
										<thead>
											<tr>
												<th>Feature</th>
												<th>Actions</th>
											</tr>
										</thead>
										<tbody id="areaFeaturesBody"></tbody>
									</table>
									<table id="saleItemsTable" class="itemTable">
										<thead>
											<tr>
												<th>For Sale</th>
												<th>Actions</th>
											</tr>
										</thead>
										<tbody id="saleItemsBody"></tbody>
									</table>
								</div>
								<div id="tabcontent-inventory" class="subcontent tabcontent">
									<div id="toolBox">
										<table id="toolsTable" class="itemTable">
											<thead>
												<tr>
													<th>Tool</th>
													<th>Actions</th>
												</tr>
											</thead>
											<tbody id="toolTableBody"></tbody>
										</table>
									</div>
									<div id="noToolBox"><i>You currently have no tools</i></div>
									<div id="inventoryBox">
										<table id="inventoryTable" class="itemTable">
											<thead>
												<tr>
													<th>Item</th>
													<th>Actions</th>
												</tr>
											</thead>
											<tbody id="inventoryTableBody"></tbody>
										</table>
									</div>
									<div id="noInventoryBox"><i>Your inventory is empty</i></div>
								</div>
								<div id="tabcontent-skills" class="subcontent tabcontent">
									<div id="skillBox">
										<table id="skillsTable" class="itemTable">
											<thead>
												<tr>
													<th>Skill</th>
													<th>Level</th>
													<th>Actions</th>
												</tr>
											</thead>
											<tbody id="skillTableBody"></tbody>
										</table>
									</div>
									<div id="noSkillBox"><i>You currently have no skills</i></div>
									<hr />
									<div id="cookingInterface" class="skillInterface">
										<h4>Cooking </h4>
										<div id="knownRecipesBox" style="display: none;">
											Recipes: <select id="knownRecipesDropDown" onchange="selectRecipeToCook(this.value)"></select>
											<div id="requiredIngredientsBox" style="display: none;">
												Required Ingredients:
												<ol id="requiredIngredientsList"></ol>
												<button id="cookButton" class="redButton" onclick="tryCookRecipe()"></button>
												<div id="dontHaveIngredientsMessage"><i>You don't have the right ingredients.</i></div>
											</div>
											<div id="notNearCookingFeature" style="display: none;"><i>You don't have anywhere to cook this.</i></div>
										</div>
										<div id="noRecipesBox"><i>You don't know any recipes yet.</i></div>
									</div>
								</div>
								<div id="tabcontent-journal" class="subcontent tabcontent">
									<div id="activeQuestsBox">
										<table id="activeQuestsTable" class="itemTable">
											<thead>
												<tr>
													<th>Active Quests</th>
													<th>Actions</th>
												</tr>
											</thead>
											<tbody id="activeQuestsTableBody"></tbody>
										</table>
									</div>
									<div id="noActiveQuestsBox"><i>You currently have no active quests</i></div>
									<hr />
									<div id="completedQuestsBox">
										<table id="completedQuestsTable" class="itemTable">
											<thead>
												<tr>
													<th>Completed Quests</th>
													<th>Actions</th>
												</tr>
											</thead>
											<tbody id="completedQuestsTableBody"></tbody>
										</table>
									</div>
									<div id="noCompletedQuestsBox"><i>You haven't completed any quests</i></div>
								</div>
								<div id="tabcontent-preferences" class="subcontent tabcontent">
									<table id="preferencesTable" class="itemTable">
										<thead>
											<tr>
												<th>Preference</th>
												<th>Options</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td>Area Tab on Travel</td>
												<td>
													Yes:<input type="radio" id="pref_areaTabOnTravel_yes" name="areaTabOnTravel" onclick="modConfig.gamePreferences.areaTabOnTravel = this.checked;" />
													No: <input type="radio" id="pref_areaTabOnTravel_no" name="areaTabOnTravel" onclick="modConfig.gamePreferences.areaTabOnTravel = !this.checked;" />
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
					<div id="statBox" data-subcontent-type="stat" data-subcontent-default="block" data-subcontent="basic">
						<div id="miniCalendar" class="morning clearWeather">
							<span id="currentDayOfWeek"></span>, <span id="currentSeason"></span> <span id="currentSeasonDay"></span> - 
							<span id="timeOfDayHour">6</span>:<span id="timeOfDayMinutes">00</span> <span id="timeOfDayAmPm">AM</span>
							<span id="timeOfDayEmoji" class="sunEmoji" aria-hidden="true"></span>
						</div>
						<div id="stat-basic" class="stat">
							<h4>Stamina: <span id="currentStaminaPercent"></span> - Money: $<span id="currentMoney"></span></h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>
	<script> //initialization
	
		function initialize()
		{
			setSubcontent('gameBox', 'pregame');
			var cb = g("continueButton");
			var saves = getGameSaves();
			if (saves !== null && saves.length > 0)
			{
				console.log(saves);
				cb.disabled = false;
				cb.style.display = 'inline';
			}
			else
			{
				cb.disabled = true;
				cb.style.display = 'none';
			}
			clearNarration();
			addNarrationMessage('Pre-alpha release. Bugs may be present, please be patient.');
			addNarrationMessage('Click New Game to start a new game, or Continue if you have a game saved.');
			backfillPlaceholders();
			setupCharacterAppearanceOptions();
		}
		function backfillPlaceholders()
		{
			var placeholders = document.getElementsByClassName('placeholder');
			for (var i=0;i<placeholders.length;i++)
			{
				placeholders[i].innerHTML = eval(placeholders[i].getAttribute('data-content'));
			}
		}
		function setupCharacterAppearanceOptions()
		{
			if (rint(2) == 0) { g('sexInputMale').checked = true; }
			else { g('sexInputFemale').checked = true; }
			
			var c = 0;
			for (var key in modData.types.heights)
			{
				var o = ce('option');
				o.value = key;
				o.innerHTML = modData.types.heights[key].displayName;
				g('heightInput').appendChild(o);
				c++;
			}
			g('heightInput').getElementsByTagName('option')[rint(c)].selected = true;
			c = 0;
			for (var key in modData.types.bodies)
			{
				var o = ce('option');
				o.value = key;
				o.innerHTML = modData.types.bodies[key].displayName;
				g('bodyTypeInput').appendChild(o);
				c++;
			}
			g('bodyTypeInput').getElementsByTagName('option')[rint(c)].selected = true;
			for (var i=0;i<modData.types.hairColorsNatural.length;i++)
			{
				var o = ce('option');
				o.value = modData.types.hairColorsNatural[i];
				o.innerHTML = modData.types.hairColors[modData.types.hairColorsNatural[i]].displayName;
				g('hairInput').appendChild(o);
			}
			g('hairInput').getElementsByTagName('option')[rint(modData.types.hairColorsNatural.length)].selected = true;
			c = 0;
			for (var key in modData.types.hairStyles)
			{
				var o = ce('option');
				o.value = key;
				o.innerHTML = modData.types.hairStyles[key].displayName;
				g('hairStyleInput').appendChild(o);
				c++;
			}
			g('hairStyleInput').getElementsByTagName('option')[rint(c)].selected = true;
			c = 0;
			for (var key in modData.types.eyeColors)
			{
				var o = ce('option');
				o.value = key;
				o.innerHTML = modData.types.eyeColors[key].displayName;
				g('eyeInput').appendChild(o);
				c++;
			}
			g('eyeInput').getElementsByTagName('option')[rint(c)].selected = true;
			c = 0;
			for (var key in modData.types.aesthetics)
			{
				var o = ce('option');
				o.value = key;
				o.innerHTML = modData.types.aesthetics[key].displayName;
				g('aestheticInput').appendChild(o);
				c++;
			}
			g('aestheticInput').getElementsByTagName('option')[rint(c)].selected = true;			
		}
		initialize();
		
	</script>
</body>
